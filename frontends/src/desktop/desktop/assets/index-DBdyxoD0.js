var xe=Object.defineProperty;var Oe=(e,t,n)=>t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var re=(e,t,n)=>Oe(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function q(){}function we(e){return e()}function ae(){return Object.create(null)}function J(e){e.forEach(we)}function ve(e){return typeof e=="function"}function Se(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function De(e){return Object.keys(e).length===0}function a(e,t){e.appendChild(t)}function B(e,t,n){e.insertBefore(t,n||null)}function $(e){e.parentNode&&e.parentNode.removeChild(e)}function ke(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function p(e){return document.createElement(e)}function W(e){return document.createTextNode(e)}function S(){return W(" ")}function V(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function h(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ne(e){return Array.from(e.childNodes)}function Z(e,t){t=""+t,e.data!==t&&(e.data=t)}function ce(e,t){e.value=t==null?"":t}function M(e,t,n){e.classList.toggle(t,!!n)}let Q;function H(e){Q=e}function Ee(){if(!Q)throw new Error("Function called outside component initialization");return Q}function Ae(e){Ee().$$.on_mount.push(e)}function Re(e){Ee().$$.on_destroy.push(e)}const U=[],ue=[];let G=[];const de=[],Ie=Promise.resolve();let ie=!1;function We(){ie||(ie=!0,Ie.then(Ce))}function oe(e){G.push(e)}const se=new Set;let j=0;function Ce(){if(j!==0)return;const e=Q;do{try{for(;j<U.length;){const t=U[j];j++,H(t),Le(t.$$)}}catch(t){throw U.length=0,j=0,t}for(H(null),U.length=0,j=0;ue.length;)ue.pop()();for(let t=0;t<G.length;t+=1){const n=G[t];se.has(n)||(se.add(n),n())}G.length=0}while(U.length);for(;de.length;)de.pop()();ie=!1,se.clear(),H(e)}function Le(e){if(e.fragment!==null){e.update(),J(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(oe)}}function Me(e){const t=[],n=[];G.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),G=t}const Fe=new Set;function $e(e,t){e&&e.i&&(Fe.delete(e),e.i(t))}function ne(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Pe(e,t,n){const{fragment:r,after_update:s}=e.$$;r&&r.m(t,n),oe(()=>{const i=e.$$.on_mount.map(we).filter(ve);e.$$.on_destroy?e.$$.on_destroy.push(...i):J(i),e.$$.on_mount=[]}),s.forEach(oe)}function Te(e,t){const n=e.$$;n.fragment!==null&&(Me(n.after_update),J(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function je(e,t){e.$$.dirty[0]===-1&&(U.push(e),We(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Ue(e,t,n,r,s,i,l=null,c=[-1]){const u=Q;H(e);const o=e.$$={fragment:null,ctx:[],props:i,update:q,not_equal:s,bound:ae(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:ae(),dirty:c,skip_bound:!1,root:t.target||u.$$.root};l&&l(o.root);let w=!1;if(o.ctx=n?n(e,t.props||{},(_,m,...b)=>{const A=b.length?b[0]:m;return o.ctx&&s(o.ctx[_],o.ctx[_]=A)&&(!o.skip_bound&&o.bound[_]&&o.bound[_](A),w&&je(e,_)),m}):[],o.update(),w=!0,J(o.before_update),o.fragment=r?r(o.ctx):!1,t.target){if(t.hydrate){const _=Ne(t.target);o.fragment&&o.fragment.l(_),_.forEach($)}else o.fragment&&o.fragment.c();t.intro&&$e(e.$$.fragment),Pe(e,t.target,t.anchor),Ce()}H(u)}class ze{constructor(){re(this,"$$");re(this,"$$set")}$destroy(){Te(this,1),this.$destroy=q}$on(t,n){if(!ve(n))return q;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(t){this.$$set&&!De(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ge="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ge);function Be(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)}function Ke(e,t,n,r,s){if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var te;function Ve(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}async function f(e,t={},n){return window.__TAURI_INTERNALS__.invoke(e,t,n)}class He{get rid(){return Be(this,te,"f")}constructor(t){te.set(this,void 0),Ke(this,te,t)}async close(){return f("plugin:resources|close",{rid:this.rid})}}te=new WeakMap;var fe;(function(e){e.WINDOW_RESIZED="tauri://resize",e.WINDOW_MOVED="tauri://move",e.WINDOW_CLOSE_REQUESTED="tauri://close-requested",e.WINDOW_DESTROYED="tauri://destroyed",e.WINDOW_FOCUS="tauri://focus",e.WINDOW_BLUR="tauri://blur",e.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",e.WINDOW_THEME_CHANGED="tauri://theme-changed",e.WINDOW_CREATED="tauri://window-created",e.WEBVIEW_CREATED="tauri://webview-created",e.DRAG_ENTER="tauri://drag-enter",e.DRAG_OVER="tauri://drag-over",e.DRAG_DROP="tauri://drag-drop",e.DRAG_LEAVE="tauri://drag-leave"})(fe||(fe={}));async function qe(e,t){await f("plugin:event|unlisten",{event:e,eventId:t})}async function z(e,t,n){var r;const s=(r=void 0)!==null&&r!==void 0?r:{kind:"Any"};return f("plugin:event|listen",{event:e,target:s,handler:Ve(t)}).then(i=>async()=>qe(e,i))}class Y extends He{constructor(t){super(t)}static async load(t,n){const r=await f("plugin:store|load",{path:t,...n});return new Y(r)}static async get(t){return await f("plugin:store|get_store",{path:t}).then(n=>n?new Y(n):null)}async set(t,n){await f("plugin:store|set",{rid:this.rid,key:t,value:n})}async get(t){const[n,r]=await f("plugin:store|get",{rid:this.rid,key:t});return r?n:void 0}async has(t){return await f("plugin:store|has",{rid:this.rid,key:t})}async delete(t){return await f("plugin:store|delete",{rid:this.rid,key:t})}async clear(){await f("plugin:store|clear",{rid:this.rid})}async reset(){await f("plugin:store|reset",{rid:this.rid})}async keys(){return await f("plugin:store|keys",{rid:this.rid})}async values(){return await f("plugin:store|values",{rid:this.rid})}async entries(){return await f("plugin:store|entries",{rid:this.rid})}async length(){return await f("plugin:store|length",{rid:this.rid})}async reload(){await f("plugin:store|reload",{rid:this.rid})}async save(){await f("plugin:store|save",{rid:this.rid})}async onKeyChange(t,n){return await z("store://change",r=>{r.payload.resourceId===this.rid&&r.payload.key===t&&n(r.payload.exists?r.payload.value:void 0)})}async onChange(t){return await z("store://change",n=>{n.payload.resourceId===this.rid&&t(n.payload.key,n.payload.exists?n.payload.value:void 0)})}}const Qe={storage:{local:{get:async e=>{const t=await Y.load("my_app_store10.bin");try{const n=await t.get(e);return typeof n=="string"||n===null||n===void 0?{[e]:n}:{[e]:JSON.stringify(n)}}catch(n){return console.error(`Error getting ${e} from storage:`,n),{[e]:null}}},set:async e=>{const t=await Y.load("my_app_store10.bin");try{const n=Object.keys(e)[0],r=e[n];if(typeof n!="string"||typeof r!="string")throw new Error("Both key and value must be strings");console.log(n,r),await t.set(n,r),await t.save()}catch(n){console.error("Error setting data in storage:",n)}}}},tabs:{query:async e=>(console.log("Tauri: Query tabs",e),[])},runtime:{sendMessage:async({action:e,data:t})=>{try{const r={isSignedUp:()=>f("check_signup_status"),savePassphrase:s=>f("handle_save_passphrase",{input:s}),checkPvtLoaded:()=>f("check_private_key_loaded"),getPubKey:s=>f("handle_get_public_key",{input:s}),signChallenge:s=>f("handle_sign_challenge",{input:s}),addCredential:s=>f("handle_add_credential",{input:s}),hashAndSign:s=>f("handle_hash_and_sign",{input:s}),importPvtKey:s=>f("handle_import_certificate",{input:s}),exportCertificate:s=>f("handle_export_certificate",{input:s}),changePassphrase:s=>f("handle_change_passphrase",{input:s}),addFolder:s=>f("handle_add_folder",{input:s}),getFolder:()=>f("handle_get_folders"),getCredentialsForFolder:s=>f("handle_get_credentials_for_folder",{input:s})}[e];if(!r)throw new Error(`Unknown action: ${e}`);return await r(t)}catch(n){throw console.error("Error invoking Tauri command:",n),n}},onMessage:{addListener:e=>{console.log("Tauri: Adding message listener")}}}},Ye=async(e,t={})=>{try{return await Qe.runtime.sendMessage({action:e,data:t})}catch(n){console.error("Error sending message:",n,`
data`,t,`action
`,e)}};function he(e,t,n){const r=e.slice();return r[14]=t[n],r}function pe(e,t,n){const r=e.slice();return r[17]=t[n],r}function ge(e){let t,n,r,s,i,l,c,u,o,w;return{c(){t=p("div"),n=p("div"),r=p("strong"),r.textContent="Error:",s=S(),i=p("span"),l=W(e[2]),c=S(),u=p("button"),u.textContent="Ã—",h(r,"class","font-bold"),h(i,"class","block sm:inline"),h(u,"class","ml-4 font-bold"),h(t,"class","bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 flex items-start justify-between")},m(_,m){B(_,t,m),a(t,n),a(n,r),a(n,s),a(n,i),a(i,l),a(t,c),a(t,u),o||(w=V(u,"click",e[9]),o=!0)},p(_,m){m&4&&Z(l,_[2])},d(_){_&&$(t),o=!1,w()}}}function _e(e){let t,n,r,s,i,l,c,u,o,w,_;return{c(){t=p("div"),n=p("h2"),n.textContent="Your Connection Ticket:",r=S(),s=p("div"),i=W(e[0]),l=S(),c=p("button"),u=W("Copy Ticket"),h(n,"class","font-semibold mb-2"),h(s,"class","bg-white p-3 rounded break-all mb-2 font-mono text-sm"),h(c,"class","bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors disabled:bg-gray-400"),c.disabled=o=!e[0],h(t,"class","bg-gray-100 p-4 rounded mb-4")},m(m,b){B(m,t,b),a(t,n),a(t,r),a(t,s),a(s,i),a(t,l),a(t,c),a(c,u),w||(_=V(c,"click",e[6]),w=!0)},p(m,b){b&1&&Z(i,m[0]),b&1&&o!==(o=!m[0])&&(c.disabled=o)},d(m){m&&$(t),w=!1,_()}}}function ye(e){let t,n=e[17].text+"",r,s,i;return{c(){t=p("div"),r=W(n),s=S(),h(t,"class",i="p-2 rounded-lg max-w-[80%] "+(e[17].sent?"bg-blue-500 text-white ml-auto":"bg-gray-100 mr-auto"))},m(l,c){B(l,t,c),a(t,r),a(t,s)},p(l,c){c&16&&n!==(n=l[17].text+"")&&Z(r,n),c&16&&i!==(i="p-2 rounded-lg max-w-[80%] "+(l[17].sent?"bg-blue-500 text-white ml-auto":"bg-gray-100 mr-auto"))&&h(t,"class",i)},d(l){l&&$(t)}}}function me(e){let t,n,r,s,i=ne([...e[3]]),l=[];for(let c=0;c<i.length;c+=1)l[c]=be(he(e,i,c));return{c(){t=p("div"),n=p("h2"),n.textContent="Connected Devices:",r=S(),s=p("ul");for(let c=0;c<l.length;c+=1)l[c].c();h(n,"class","font-semibold mb-2"),h(s,"class","list-disc pl-5"),h(t,"class","mt-4")},m(c,u){B(c,t,u),a(t,n),a(t,r),a(t,s);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(s,null)},p(c,u){if(u&8){i=ne([...c[3]]);let o;for(o=0;o<i.length;o+=1){const w=he(c,i,o);l[o]?l[o].p(w,u):(l[o]=be(w),l[o].c(),l[o].m(s,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=i.length}},d(c){c&&$(t),ke(l,c)}}}function be(e){let t,n=e[14]+"",r;return{c(){t=p("li"),r=W(n),h(t,"class","text-gray-700")},m(s,i){B(s,t,i),a(t,r)},p(s,i){i&8&&n!==(n=s[14]+"")&&Z(r,n)},d(s){s&&$(t)}}}function Je(e){let t,n,r,s,i,l,c,u,o,w,_,m,b,A,X,F,g,N,E,R,D,L,I,ee,K,P,y=e[2]&&ge(e),v=e[0]&&_e(e),T=ne(e[4]),C=[];for(let d=0;d<T.length;d+=1)C[d]=ye(pe(e,T,d));let x=e[3].size>0&&me(e);return{c(){t=p("main"),n=p("div"),r=p("h1"),r.textContent="Desktop Connection",s=S(),i=p("div"),l=p("p"),c=W("Status: "),u=p("span"),o=W(e[1]),w=S(),y&&y.c(),_=S(),v&&v.c(),m=S(),b=p("div"),A=p("h2"),A.textContent="Messages",X=S(),F=p("div");for(let d=0;d<C.length;d+=1)C[d].c();g=S(),N=p("div"),E=p("textarea"),R=S(),D=p("button"),L=W("Send"),ee=S(),x&&x.c(),h(r,"class","text-2xl font-bold mb-4"),h(u,"class","px-2 py-1 rounded"),M(u,"text-blue-600",e[1].includes("Ready")),M(u,"text-yellow-600",e[1].includes("trying")),M(u,"text-green-600",e[1].includes("successfully")),M(u,"text-red-600",e[1].includes("Failed")||e[1].includes("disconnected")),h(l,"class","font-semibold"),h(i,"class","mb-4"),h(A,"class","font-semibold mb-2"),h(F,"class","bg-white border rounded-lg p-4 h-96 overflow-y-auto flex flex-col gap-2 mb-4"),h(E,"class","flex-1 p-2 border rounded resize-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"),h(E,"rows","2"),h(E,"placeholder","Type your message..."),h(D,"class","bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors disabled:bg-gray-400"),D.disabled=I=!e[5].trim(),h(N,"class","flex gap-2"),h(b,"class","mt-6"),h(n,"class","max-w-2xl mx-auto"),h(t,"class","container p-4 mx-auto")},m(d,O){B(d,t,O),a(t,n),a(n,r),a(n,s),a(n,i),a(i,l),a(l,c),a(l,u),a(u,o),a(n,w),y&&y.m(n,null),a(n,_),v&&v.m(n,null),a(n,m),a(n,b),a(b,A),a(b,X),a(b,F);for(let k=0;k<C.length;k+=1)C[k]&&C[k].m(F,null);a(b,g),a(b,N),a(N,E),ce(E,e[5]),a(N,R),a(N,D),a(D,L),a(n,ee),x&&x.m(n,null),K||(P=[V(E,"input",e[10]),V(E,"keypress",e[8]),V(D,"click",e[7])],K=!0)},p(d,[O]){if(O&2&&Z(o,d[1]),O&2&&M(u,"text-blue-600",d[1].includes("Ready")),O&2&&M(u,"text-yellow-600",d[1].includes("trying")),O&2&&M(u,"text-green-600",d[1].includes("successfully")),O&2&&M(u,"text-red-600",d[1].includes("Failed")||d[1].includes("disconnected")),d[2]?y?y.p(d,O):(y=ge(d),y.c(),y.m(n,_)):y&&(y.d(1),y=null),d[0]?v?v.p(d,O):(v=_e(d),v.c(),v.m(n,m)):v&&(v.d(1),v=null),O&16){T=ne(d[4]);let k;for(k=0;k<T.length;k+=1){const le=pe(d,T,k);C[k]?C[k].p(le,O):(C[k]=ye(le),C[k].c(),C[k].m(F,null))}for(;k<C.length;k+=1)C[k].d(1);C.length=T.length}O&32&&ce(E,d[5]),O&32&&I!==(I=!d[5].trim())&&(D.disabled=I),d[3].size>0?x?x.p(d,O):(x=me(d),x.c(),x.m(n,null)):x&&(x.d(1),x=null)},i:q,o:q,d(d){d&&$(t),y&&y.d(),v&&v.d(),ke(C,d),x&&x.d(),K=!1,J(P)}}}function Ze(e,t,n){var r=this&&this.__awaiter||function(g,N,E,R){function D(L){return L instanceof E?L:new E(function(I){I(L)})}return new(E||(E=Promise))(function(L,I){function ee(y){try{P(R.next(y))}catch(v){I(v)}}function K(y){try{P(R.throw(y))}catch(v){I(v)}}function P(y){y.done?L(y.value):D(y.value).then(ee,K)}P((R=R.apply(g,N||[])).next())})};let s="",i="Initializing...",l="",c=new Set,u=[],o="",w=[];function _(){return r(this,void 0,void 0,function*(){const g=yield z("peer-connected",()=>{n(1,i="Mobile device trying to connect...")}),N=yield z("sync-complete",()=>{n(1,i="Mobile device connected successfully")}),E=yield z("peer-down",D=>{c.delete(D.payload),n(3,c),n(1,i="Mobile device disconnected")}),R=yield z("message-received",D=>{n(4,u=[...u,{text:D.payload,sent:!1}])});w.push(g,N,E,R)})}Ae(()=>r(void 0,void 0,void 0,function*(){try{yield f("start_p2p_listener"),yield _(),n(0,s=yield f("get_ticket"));const g=yield Ye("exportCertificate",{passphrase:"test"});console.log("Certificate:",g),n(1,i="Ready to connect. Share the ticket with mobile device.")}catch(g){n(2,l=g.toString()),n(1,i="Failed to initialize"),console.error("Error generating ticket:",g)}})),Re(()=>{w.forEach(g=>g())});function m(){return r(this,void 0,void 0,function*(){try{yield navigator.clipboard.writeText(s);const g=i;n(1,i="Ticket copied to clipboard!"),setTimeout(()=>{n(1,i=g)},2e3)}catch(g){n(2,l="Failed to copy ticket"),console.error("Copy error:",g)}})}function b(){return r(this,void 0,void 0,function*(){if(o.trim())try{yield f("send_message",{message:o}),n(4,u=[...u,{text:o,sent:!0}]),n(5,o="")}catch(g){n(2,l="Failed to send message: "+g.toString()),console.error("Send error:",g)}})}function A(g){g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),b())}const X=()=>n(2,l="");function F(){o=this.value,n(5,o)}return[s,i,l,c,u,o,m,b,A,X,F]}class Xe extends ze{constructor(t){super(),Ue(this,t,Ze,Je,Se,{})}}new Xe({target:document.body});
